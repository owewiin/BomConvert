SchBom Convert (HiddenLog 版本)  

一個用於轉換和格式化 BOM (Bill of Materials) 清單的 WPF 應用程式，專為電子零件清單管理設計。  
本版本特色：操作紀錄自動寫入隱藏資料夾，僅管理者可用熱鍵查閱後台日誌。  

版本歷史  
V1.2 (2025/07/11)  
✅ 新增「轉換資訊」功能：左側欄新增按鈕，可查看所有處理訊息（合併、警告、錯誤等）  
✅ 修正人員管理按鈕：修復新增/刪除人員按鈕事件綁定錯誤  
✅ SMD/DIP 零件分類邏輯優化，合金電阻等特殊分類不會被一般電阻吃掉，分類順序依照 componentMappings 宣告順序執行  
✅ SMD、DIP 零件細分類支援更多新型態（如SMD RJ45座、DIP 歐規、DIP 編碼開關等）  
✅ 規格顯示格式優化（尺寸、阻值、精度間空格處理）  
✅ 單價解析失敗時會顯示錯誤訊息，方便追蹤資料問題  
✅ 其他細部修正與穩定性提升  

V1.1-hiddenlog (2025/07/09)  
✅ 所有操作紀錄（啟動、匯出、開檔、修改人員設定）自動寫入 .sys/sysdata.dat 隱藏檔案  
✅ 後台日誌視窗（Ctrl+Alt+L）可即時查閱所有紀錄  
✅ 一般使用者無法發現 log 檔案，僅管理者可存取  
✅ 其餘功能同正式版  

V1.0 (2025/07/03) 已發布版本  
✅ 支援 SMD/DIP 零件自動分類  
✅ 智能替代料解析  
✅ 人員設定持久化  
✅ NC 零件特殊處理  
✅ 自動開啟匯出檔案選項  
✅ Material Design UI 

## 功能特色

### 📋 BOM 資料處理
- **自動識別零件類型**：智能識別 SMD、DIP 等不同封裝的電子零件，分類順序可自訂，特殊零件（如合金電阻）不會被一般類型覆蓋
- **智能分類排序**：按照零件類型、規格、封裝尺寸自動分類和排序
- **替代料處理**：支援替代料資訊的解析和格式化
- **NC 零件支援**：特別處理 NC (No Connect) 零件
- **轉換資訊顯示**：即時查看處理過程中的所有訊息和警告

### 📤 匯出功能
- **標準化 Excel 輸出**：生成符合公司規範的 BOM 清單
- **多分類料表**：自動分為 SMD 料表、DIP 料表、其他料表
- **自動計算**：自動計算小計和總計
- **工程人員資訊**：包含研發助理、Layout 人員、線路設計人員資訊

### ⚙️ 個人化設定
- **人員設定管理**：可自訂工程人員名單
- **設定檔案儲存**：設定自動儲存到 JSON 檔案，支援 NAS 環境
- **自動開啟檔案**：可設定匯出後自動開啟生成的檔案
- **轉換資訊面板**：左側欄新增按鈕，查看所有處理訊息

## 系統需求

- Windows 10 或更新版本
- .NET 6.0 或更新版本
- Microsoft Excel (用於開啟生成的檔案)

## 安裝說明

### 從原始碼編譯
1. 克隆專案
```bash
git clone [repository-url]
cd SchBom_Convert
```

2. 安裝相依套件
```bash
dotnet restore
```

3. 編譯專案
```bash
dotnet build --configuration Release
```

4. 執行應用程式
```bash
dotnet run
```

### 相依套件
- **MaterialDesignInXamlToolkit**: 提供 Material Design 風格的 UI 元件
- **ExcelDataReader**: 用於讀取 Excel 檔案
- **ClosedXML**: 用於生成和操作 Excel 檔案
- **System.Text.Encoding.CodePages**: 支援多種文字編碼

## 使用說明

### 1. 載入 BOM 檔案
1. 點擊「選擇檔案」按鈕
2. 選擇要處理的 Excel 檔案 (.xlsx, .xls, .xlt)
3. 系統會自動載入並解析資料

### 2. 預覽資料
1. 點擊「📝 預覽」按鈕
2. 檢查解析結果和分類是否正確
3. 確認替代料格式：應為「規格(廠商/代理商)」格式

### 3. 設定工程人員
1. 點擊「⚙️ 人員設定」
2. 設定或選擇：
   - 研發助理人員
   - Layout 人員  
   - 線路設計人員
3. 點擊「💾 儲存設定」

### 4. 匯出 BOM 清單
1. 點擊「📤 匯出 Excel」
2. 選擇儲存位置和檔案名稱
3. 系統會生成標準化的 BOM 清單

## 檔案格式要求

### 輸入 Excel 格式
預期的 Excel 檔案結構（從第 6 行開始）：
| 欄位 | 說明 |
|------|------|
| A | 項次 |
| B | 零件名稱 |
| C | 規格 |
| D | 封裝 |
| E | 數量 |
| F | 零件編號 |
| G | 單價 |
| H | 廠商 |
| I | 備註 |
| J | 製程 |
| K | 替代料1 |
| L | 中國零件編號 |
| M | 中國廠商 |
| N | 中國替代料 |
| O | 替代料2 |

### 輸出格式
生成的 Excel 檔案包含：
- 公司標頭資訊
- 按類型分組的零件清單 (SMD/DIP/其他)
- 自動計算的小計和總計
- 工程人員資訊和日期
- NC 零件特殊標記

## 零件識別規則

### SMD 零件分類
系統會自動識別以下 SMD 零件類型：
- 電阻、合金電阻
- 電容、鉭電
- 電感、三端濾波器
- 二極體、蕭特基、稽納、LED
- 電晶體、MOSFET
- 各種 IC (MCU, OP, DC/DC, LDO 等)
- 保護元件 (保險絲, BEAD, TVS, ESD)
- 連接器和感測器

### DIP 零件分類  
- 電阻、水泥電阻
- 電解電容、安規電容
- 電感、CHOKE、變壓器
- 二極體、橋式整流器
- 主動元件 (BJT, MOSFET, IGBT, RELAY)
- 模組和感測器
- 人機介面元件
- 機構件 (散熱片、銅塊等)

### 排序邏輯
- **SMD 零件**：按尺寸 (0603→0805→1206...) 和類型排序
- **DIP 零件**：按元件功能和重要性排序
- **電阻**：按阻值大小排序 (1R→10R→100R→1K→10K...)
- **電容**：按容值大小排序 (小→大)

## 開發資訊

### 專案結構
```
SchBom_Convert/
├── MainWindow.xaml          # 主視窗 UI 定義
├── MainWindow.xaml.cs       # 主要業務邏輯
├── App.xaml                 # 應用程式設定
├── App.xaml.cs             # 應用程式進入點
└── README.md               # 專案說明文件
```

### 核心類別
- `BomItem`: 原始 BOM 資料項目
- `BomPreviewItem`: 處理後的預覽資料項目
- `MainWindow`: 主要 UI 和業務邏輯控制器

### 關鍵演算法
1. **零件名稱統一**：移除尺寸資訊，保留核心零件類型
2. **智能分類**：基於零件名稱和規格的模式匹配
3. **替代料解析**：支援多種格式的替代料資訊提取
4. **重複項目合併**：相同零件的數量自動合併
